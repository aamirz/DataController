/**************************************************************************
  * A class that contains public methods to manipulate data in a 
  * specified database. 
  * 
  ************************************************************************/

public class DbController{
    
    private final String DbUrl; // takes the adress of the server 
    private final String username; // takes the username 
    private final String pass;    // takes the password 
    private Connection conn;      // establishes a connection with the server 
    
    // the constructor takes arguments to establish a connection 
    public DbController(String DbUrl, String username, String pass) {
        
        // assigns all instance variables     
        DbUrl = DbUrl.this; 
        username = username.this; 
        pass    = pass.this; 
        
        try{
            // Connect to the server 
            conn = DriverManager.getConnection(dbUrl, user, pass); 
        }
        catch (SQLException ex) {
            System.out.println(ex.getMessage()); 
        }
        
    } // termination of constructor 
    
    public boolean addTable(String) {
        return true;
    }
    
    /* a method to add one row of data into a specified table 
     * the arguments are the table name, an array of column names,
     * and an array of values */
    public boolean addData(String tableName, String[] columnNames, 
          String[] value) {
        
        // String to hold the sql command 
        String sql = "INSERT INTO " + tableName + "("; 
        String column = ""; 
        
        // builds the column names 
        for(int i = 0; i < columnNames.length; i++) {
            
            if ( i =! columnNames.length - 1) {
                column += columnNames[i] + ","
            }
            
            else column += columnNames[i]; 
        }
        
        sql = sql + column + ")" + " VALUES(";
        
        String values = ""; 
        
        // builds the values 
        for(int i = 0; i < value.length; i++) {
            
            if ( i =! value.length - 1) {
                values += value[i] + ","
            }
            
            else values += value[i]; 
        }
        
        sql = sql + values +")"; 
        
        
        // Communicates witht the database and adds a row
        Statement adder = conn.createStatement(); 
        int rowAffected = adder.executeUpdate(sql); 
        
        
        if (rowAffected === 1) return true; 
        else return false; 
    }
    
    public static void main(String args[]){
        // code to test each method in DbController    
    }
    
}
